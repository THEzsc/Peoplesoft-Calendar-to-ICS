# 日历兼容性测试指南

## v0.3.2 修复说明

本版本主要修复了Outlook等日历应用无法显示某些事件的兼容性问题。

## 🔧 主要修复内容

### 1. 事件命名格式优化
- **修复前**: `CS 101 [实验室] (LA1)` - 方括号可能导致解析问题
- **修复后**: `CS 101 - 实验室 (LA1)` - 使用更兼容的连字符格式

### 2. 特殊字符转义
- 按照RFC 5545标准转义逗号、分号、反斜杠等特殊字符
- 确保中文字符正确显示

### 3. 增加必需ICS字段
- `CREATED` - 事件创建时间
- `LAST-MODIFIED` - 最后修改时间  
- `STATUS:CONFIRMED` - 事件状态
- `TRANSP:OPAQUE` - 课程事件（占用时间）
- `TRANSP:TRANSPARENT` - 特殊事件（不占用时间）
- `CATEGORIES` - 事件分类标签

### 4. 增强事件描述
- 包含完整课程信息：课程名、类型、讲师、课程号
- 使用标准换行符格式

## 📱 测试步骤

### 1. 生成新的ICS文件
1. 在PeopleSoft课程表页面使用v0.3.2脚本
2. 点击"导出 ICS"按钮
3. 下载新的ICS文件

### 2. 测试Outlook兼容性
1. 打开Microsoft Outlook
2. 文件 → 打开和导出 → 导入/导出
3. 选择"从文件导入 iCalendar (.ics) 或 vCalendar 文件"
4. 选择生成的ICS文件
5. **验证点**:
   - 所有课程事件都能正常显示
   - 事件标题格式为"CS 101 - 实验室 (LA1)"
   - 事件描述包含完整课程信息
   - 特殊事件（开学典礼等）正常显示

### 3. 测试Google Calendar兼容性
1. 打开Google Calendar
2. 设置 → 导入和导出 → 导入
3. 选择ICS文件并导入
4. **验证点**:
   - 所有事件正确显示
   - 时间和日期准确
   - 中文显示正常

### 4. 测试iCloud Calendar兼容性
1. 在Mac上打开"日历"应用
2. 文件 → 导入
3. 选择ICS文件
4. **验证点**:
   - 事件导入成功
   - 格式显示正确
   - 同步到其他设备正常

## 🐛 问题排查

### 如果仍有事件无法显示：

1. **检查事件时间**
   - 确认事件时间在合理范围内
   - 检查时区设置是否正确

2. **检查事件标题**
   - 确认没有特殊字符导致解析失败
   - 检查中文编码是否正确

3. **检查日历应用版本**
   - 更新到最新版本的日历应用
   - 某些旧版本可能有兼容性问题

4. **重新导入**
   - 删除之前导入的事件
   - 重新导入新的ICS文件

## 📋 预期改进效果

- ✅ Outlook中所有事件都能正常显示
- ✅ 事件标题更清晰易读
- ✅ 事件描述信息更丰富
- ✅ 跨平台兼容性更好
- ✅ 符合国际ICS标准

## 🔄 如果问题依然存在

如果修复后仍有问题，请提供：
1. 使用的日历应用名称和版本
2. 具体哪些事件无法显示
3. 错误信息截图
4. 生成的ICS文件样本

我们将进一步优化兼容性。
