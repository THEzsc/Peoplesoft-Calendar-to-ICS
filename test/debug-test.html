<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试测试 - PS Calendar to ICS</title>
</head>
<body>
    <h1>调试测试页面</h1>
    
    <!-- 模拟课表结构 -->
    <div id="win0divSTDNT_ENRL_SSV2$0">
        <table id="ACE_STDNT_ENRL_SSV2$0">
            <tr>
                <td>
                    <!-- 第一门课 -->
                    <div id="win0divDERIVED_REGFRM1_DESCR20$0">
                        <table cellpadding="2" cellspacing="0" cols="1" class="PSGROUPBOXWBO" width="539">
                            <tbody>
                                <tr><td class="PAGROUPDIVIDER" align="left">CS 3301 - 计算机网络原理</td></tr>
                                <tr><td width="537">
                                    <div id="win0divCLASS_MTG_VW$0">
                                        <table id="CLASS_MTG_VW$scroll$0" cellpadding="2">
                                            <tbody>
                                                <tr>
                                                    <td>讲授</td>
                                                    <td>星期二 星期四</td>
                                                    <td>2:00PM - 3:50PM</td>
                                                    <td>16/09/2024 - 26/12/2024</td>
                                                    <td>东1A-101</td>
                                                    <td>张教授</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
            
            <tr>
                <td>
                    <!-- 第二门课 -->
                    <div id="win0divDERIVED_REGFRM1_DESCR20$1">
                        <table cellpadding="2" cellspacing="0" cols="1" class="PSGROUPBOXWBO" width="539">
                            <tbody>
                                <tr><td class="PAGROUPDIVIDER" align="left">MATH 2001 - 高等数学</td></tr>
                                <tr><td width="537">
                                    <div id="win0divCLASS_MTG_VW$1">
                                        <table id="CLASS_MTG_VW$scroll$1" cellpadding="2">
                                            <tbody>
                                                <tr>
                                                    <td>讲授</td>
                                                    <td>星期四</td>
                                                    <td>10:00AM - 11:50AM</td>
                                                    <td>16/09/2024 - 26/12/2024</td>
                                                    <td>西1-202</td>
                                                    <td>李教授</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <script>
        // 模拟 Tampermonkey 环境
        console.log("测试页面加载完成");
        console.log("课表根元素:", document.querySelector('#win0divSTDNT_ENRL_SSV2\\$0'));
        console.log("课程标题元素:", document.querySelectorAll('td.PAGROUPDIVIDER'));
        console.log("课程表格:", document.querySelectorAll('table[id*="CLASS_MTG_VW"]'));
        
        // 手动触发按钮注入（模拟用户脚本）
        setTimeout(() => {
            console.log("手动触发按钮注入");
            if (window.forceInjectDebugButton) {
                window.forceInjectDebugButton();
            } else {
                // 创建一个简单的测试按钮
                const btn = document.createElement("button");
                btn.textContent = "测试导出";
                btn.style.position = "fixed";
                btn.style.right = "16px";
                btn.style.bottom = "16px";
                btn.style.zIndex = "999999";
                btn.style.padding = "10px";
                btn.style.background = "#4CAF50";
                btn.style.color = "white";
                btn.style.border = "none";
                btn.style.borderRadius = "4px";
                btn.style.cursor = "pointer";
                btn.onclick = () => alert("请在 PeopleSoft 网站上测试完整功能");
                document.body.appendChild(btn);
            }
        }, 1000);
    </script>
</body>
</html>
